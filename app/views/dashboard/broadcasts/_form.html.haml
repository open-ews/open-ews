.card.col-md-6
  - foobar = resource
  = simple_form_for([:dashboard, resource]) do |f|
    .card-body
      .row
        .col
          = f.input :channel
        .col
          = f.input :audio_file, as: :file, required: resource.new_record?,
            input_html: { direct_upload: true, accept: Broadcast::AUDIO_CONTENT_TYPES.join(", ") }

      .hr-text Beneficiary Filters
      .row
        .col
          %label.form-label Field
        .col
          %label.form-label Operator
        .col
          %label.form-label Value

      = f.simple_fields_for :beneficiary_filter do |filter_form|
        - FieldDefinitions::BeneficiaryFields.each do |field|
          - next if BeneficiaryAddress.country_address_data?('kh') && field.name.start_with?("address.")
          - next if BeneficiaryFilter::IGNORE_FIELDS_FOR_BROADCAST.include?(field.name)

          = filter_form.simple_fields_for field.name.to_sym do |field_form|
            .row{data: { controller: "beneficiary-filter-field" }}
              .col
                .input-group.mb-2
                  %span.input-group-text
                    %input.form-check-input.m-0{type: "checkbox", data: { "beneficiary-filter-field-target": "toggleElement", action:  "beneficiary-filter-field#toggle" }}
                  %input.form-control{type: "text", value: field.name.titleize, readonly: true, data: { "beneficiary-filter-field-target": "fieldName" } }
              .col
                = field_form.input "operator", label: false, as: :select, collection: field.operator_options_for_select, required: true, input_html: { data: { "beneficiary-filter-field-target": "operator", action:  "beneficiary-filter-field#operatorChanged" } }
              .col
                .value-input
                  - if field.field_type == :list
                    = field_form.input "value", label: false, as: :select, required: true, collection: field.schema.options, input_html: { data: { "beneficiary-filter-field-target": "value" } }
                  - elsif field.field_type == :string
                    = field_form.input "value", label: false, as: :string, required: true, input_html: { data: { "beneficiary-filter-field-target": "value" } }
                  - elsif field.field_type == :value
                    = field_form.input "value", label: false, as: field.schema.input_type, required: true, html5: true, input_html: { data: { "beneficiary-filter-field-target": "value" } }

                .is-null-value-input
                  = field_form.input "value", label: false, as: :select, required: true, input_html: { data: { "beneficiary-filter-field-target": "isNullValue" } }

        .row{data: { controller: "beneficiary-addresses-filter-field" }}
          .col
            .input-group.mb-2
              %span.input-group-text
                %input.form-check-input.m-0{type: "checkbox", data: { "beneficiary-addresses-filter-field-target": "toggleElement", action:  "beneficiary-addresses-filter-field#toggle", "bs-toggle": "collapse", "bs-target": "#addresses" }}
              %input.form-control{type: "text", value: "Addresses", readonly: true, data: { "beneficiary-addresses-filter-field-target": "fieldName" }}

            #addresses.collapse.overflow-auto{
              style: "max-height: 200px",
              data: {
                controller: "address-treeview",
                "address-treeview-data-value": BeneficiaryAddress.address_data("kh").to_json,
                "address-treeview-field-name-value": "commune_codes"
              }
            }

    .card-footer.text-end
      = f.button :submit, class: 'btn btn-primary'
